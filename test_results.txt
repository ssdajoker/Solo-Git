============================= test session starts ==============================
platform linux -- Python 3.11.6, pytest-8.4.2, pluggy-1.6.0 -- /opt/computersetup/.pyenv/versions/3.11.6/bin/python
cachedir: .pytest_cache
rootdir: /home/ubuntu/code_artifacts/solo-git
configfile: pytest.ini
plugins: asyncio-1.2.0, cov-7.0.0, anyio-4.10.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 196 items

tests/test_model_router.py::test_router_initialization PASSED            [  0%]
tests/test_model_router.py::test_load_models PASSED                      [  1%]
tests/test_model_router.py::test_analyze_complexity_simple PASSED        [  1%]
tests/test_model_router.py::test_analyze_complexity_security PASSED      [  2%]
tests/test_model_router.py::test_analyze_complexity_architecture PASSED  [  2%]
tests/test_model_router.py::test_select_model_simple PASSED              [  3%]
tests/test_model_router.py::test_select_model_complex PASSED             [  3%]
tests/test_model_router.py::test_select_model_forced_tier PASSED         [  4%]
tests/test_model_router.py::test_select_model_low_budget PASSED          [  4%]
tests/test_model_router.py::test_estimate_patch_size PASSED              [  5%]
tests/test_model_router.py::test_escalate_model PASSED                   [  5%]
tests/test_model_router.py::test_escalate_from_planning PASSED           [  6%]
tests/test_model_router.py::test_complexity_score_calculation PASSED     [  6%]
tests/test_model_router_enhanced.py::test_model_config_str PASSED        [  7%]
tests/test_model_router_enhanced.py::test_complexity_metrics_str PASSED  [  7%]
tests/test_model_router_enhanced.py::test_analyze_complexity_with_file_count PASSED [  8%]
tests/test_model_router_enhanced.py::test_analyze_complexity_multiple_files_keywords PASSED [  8%]
tests/test_model_router_enhanced.py::test_analyze_complexity_with_tests PASSED [  9%]
tests/test_model_router_enhanced.py::test_analyze_complexity_spec_keyword PASSED [  9%]
tests/test_model_router_enhanced.py::test_estimate_patch_size_with_keywords PASSED [ 10%]
tests/test_model_router_enhanced.py::test_estimate_patch_size_capped PASSED [ 10%]
tests/test_model_router_enhanced.py::test_select_tier_security_sensitive PASSED [ 11%]
tests/test_model_router_enhanced.py::test_select_tier_architecture PASSED [ 11%]
tests/test_model_router_enhanced.py::test_select_tier_large_patch PASSED [ 12%]
tests/test_model_router_enhanced.py::test_select_tier_high_complexity_score PASSED [ 12%]
tests/test_model_router_enhanced.py::test_select_tier_medium_complexity PASSED [ 13%]
tests/test_model_router_enhanced.py::test_select_tier_low_complexity PASSED [ 13%]
tests/test_model_router_enhanced.py::test_get_model_for_tier_no_models PASSED [ 14%]
tests/test_model_router_enhanced.py::test_get_model_for_tier_low_budget_multiple_models PASSED [ 14%]
tests/test_model_router_enhanced.py::test_escalate_from_coding PASSED    [ 15%]
tests/test_model_router_enhanced.py::test_complexity_score_components PASSED [ 15%]
tests/test_model_router_enhanced.py::test_all_security_keywords PASSED   [ 16%]
tests/test_model_router_enhanced.py::test_all_architecture_keywords PASSED [ 16%]
tests/test_cost_guard.py::test_tracker_initialization PASSED             [ 17%]
tests/test_cost_guard.py::test_record_usage PASSED                       [ 17%]
tests/test_cost_guard.py::test_record_multiple_usage PASSED              [ 18%]
tests/test_cost_guard.py::test_track_by_model PASSED                     [ 18%]
tests/test_cost_guard.py::test_track_by_task PASSED                      [ 19%]
tests/test_cost_guard.py::test_persistence PASSED                        [ 19%]
tests/test_cost_guard.py::test_check_budget_within_limit PASSED          [ 20%]
tests/test_cost_guard.py::test_check_budget_exceeds_limit PASSED         [ 20%]
tests/test_cost_guard.py::test_budget_alert_threshold PASSED             [ 21%]
tests/test_cost_guard.py::test_get_remaining_budget PASSED               [ 21%]
tests/test_cost_guard.py::test_record_usage_through_guard PASSED         [ 22%]
tests/test_cost_guard.py::test_get_status PASSED                         [ 22%]
tests/test_cost_guard.py::test_daily_usage_serialization PASSED          [ 23%]
tests/test_cost_guard.py::test_weekly_stats PASSED                       [ 23%]
tests/test_cost_guard_enhanced.py::test_load_history_corrupted_file PASSED [ 24%]
tests/test_cost_guard_enhanced.py::test_load_history_empty_file PASSED   [ 25%]
tests/test_cost_guard_enhanced.py::test_save_history_error_handling PASSED [ 25%]
tests/test_cost_guard_enhanced.py::test_record_usage_day_rollover PASSED [ 26%]
tests/test_cost_guard_enhanced.py::test_record_usage_new_day PASSED      [ 26%]
tests/test_cost_guard_enhanced.py::test_get_today_tokens_no_usage PASSED [ 27%]
tests/test_cost_guard_enhanced.py::test_get_today_cost_no_usage PASSED   [ 27%]
tests/test_cost_guard_enhanced.py::test_get_usage_breakdown_no_usage PASSED [ 28%]
tests/test_cost_guard_enhanced.py::test_get_weekly_stats PASSED          [ 28%]
tests/test_cost_guard_enhanced.py::test_check_budget_alert_threshold PASSED [ 29%]
tests/test_cost_guard_enhanced.py::test_daily_usage_to_dict PASSED       [ 29%]
tests/test_cost_guard_enhanced.py::test_daily_usage_from_dict PASSED     [ 30%]
tests/test_cost_guard_enhanced.py::test_daily_usage_from_dict_no_breakdowns PASSED [ 30%]
tests/test_cost_guard_enhanced.py::test_cost_guard_get_status PASSED     [ 31%]
tests/test_cost_guard_enhanced.py::test_tracker_persistence PASSED       [ 31%]
tests/test_cost_guard_enhanced.py::test_multiple_models_tracking PASSED  [ 32%]
tests/test_cost_guard_enhanced.py::test_multiple_tasks_tracking PASSED   [ 32%]
tests/test_cost_guard_enhanced.py::test_budget_config_defaults PASSED    [ 33%]
tests/test_cost_guard_enhanced.py::test_cost_calculation PASSED          [ 33%]
tests/test_cost_guard_enhanced.py::test_zero_cost_usage PASSED           [ 34%]
tests/test_planning_engine.py::test_engine_initialization PASSED         [ 34%]
tests/test_planning_engine.py::test_generate_plan_mock PASSED            [ 35%]
tests/test_planning_engine.py::test_generate_plan_with_context PASSED    [ 35%]
tests/test_planning_engine.py::test_file_change_creation PASSED          [ 36%]
tests/test_planning_engine.py::test_code_plan_to_dict PASSED             [ 36%]
tests/test_planning_engine.py::test_code_plan_str_representation PASSED  [ 37%]
tests/test_planning_engine.py::test_parse_plan_response PASSED           [ 37%]
tests/test_planning_engine.py::test_parse_plan_response_with_markdown PASSED [ 38%]
tests/test_planning_engine.py::test_generate_mock_plan_add_feature PASSED [ 38%]
tests/test_planning_engine.py::test_generate_mock_plan_fix_bug PASSED    [ 39%]
tests/test_planning_engine.py::test_fallback_plan_creation PASSED        [ 39%]
tests/test_planning_engine.py::test_format_file_tree PASSED              [ 40%]
tests/test_planning_engine_enhanced.py::test_code_plan_with_dependencies PASSED [ 40%]
tests/test_planning_engine_enhanced.py::test_code_plan_without_dependencies PASSED [ 41%]
tests/test_planning_engine_enhanced.py::test_code_plan_with_estimated_lines PASSED [ 41%]
tests/test_planning_engine_enhanced.py::test_generate_plan_with_file_tree_context PASSED [ 42%]
tests/test_planning_engine_enhanced.py::test_generate_plan_with_recent_changes_context PASSED [ 42%]
tests/test_planning_engine_enhanced.py::test_generate_plan_with_language_context PASSED [ 43%]
tests/test_planning_engine_enhanced.py::test_generate_plan_with_deployment_credentials PASSED [ 43%]
tests/test_planning_engine_enhanced.py::test_generate_plan_api_error_fallback PASSED [ 44%]
tests/test_planning_engine_enhanced.py::test_format_file_tree_with_list PASSED [ 44%]
tests/test_planning_engine_enhanced.py::test_format_file_tree_with_large_list PASSED [ 45%]
tests/test_planning_engine_enhanced.py::test_format_file_tree_with_string PASSED [ 45%]
tests/test_planning_engine_enhanced.py::test_parse_plan_response_clean_json PASSED [ 46%]
tests/test_planning_engine_enhanced.py::test_parse_plan_response_with_markdown_json PASSED [ 46%]
tests/test_planning_engine_enhanced.py::test_parse_plan_response_with_markdown PASSED [ 47%]
tests/test_planning_engine_enhanced.py::test_parse_plan_response_invalid_json PASSED [ 47%]
tests/test_planning_engine_enhanced.py::test_parse_plan_response_json_with_text PASSED [ 48%]
tests/test_planning_engine_enhanced.py::test_parse_plan_response_malformed_json_fallback PASSED [ 48%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_add_feature PASSED [ 49%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_add_test PASSED [ 50%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_add_api PASSED [ 50%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_add_cli PASSED [ 51%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_fix_bug PASSED [ 51%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_refactor PASSED [ 52%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_improve PASSED [ 52%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_generic PASSED [ 53%]
tests/test_planning_engine_enhanced.py::test_create_fallback_plan PASSED [ 53%]
tests/test_planning_engine_enhanced.py::test_generate_plan_with_all_context_types PASSED [ 54%]
tests/test_planning_engine_enhanced.py::test_generate_plan_empty_context PASSED [ 54%]
tests/test_planning_engine_enhanced.py::test_code_plan_to_dict_complete PASSED [ 55%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_create_keyword PASSED [ 55%]
tests/test_planning_engine_enhanced.py::test_generate_mock_plan_implement_keyword PASSED [ 56%]
tests/test_code_generator.py::test_generator_initialization PASSED       [ 56%]
tests/test_code_generator.py::test_generate_patch_mock PASSED            [ 57%]
tests/test_code_generator.py::test_generated_patch_str PASSED            [ 57%]
tests/test_code_generator.py::test_extract_diff_from_markdown PASSED     [ 58%]
tests/test_code_generator.py::test_extract_files_from_diff PASSED        [ 58%]
tests/test_code_generator.py::test_count_changes PASSED                  [ 59%]
tests/test_code_generator.py::test_generate_mock_patch_create PASSED     [ 59%]
tests/test_code_generator.py::test_generate_mock_patch_modify PASSED     [ 60%]
tests/test_code_generator.py::test_generate_mock_patch_delete PASSED     [ 60%]
tests/test_code_generator.py::test_create_fallback_patch PASSED          [ 61%]
tests/test_code_generator.py::test_generate_patch_with_file_contents PASSED [ 61%]
tests/test_code_generator.py::test_generate_patch_from_feedback PASSED   [ 62%]
tests/test_code_generator_enhanced.py::test_generated_patch_str PASSED   [ 62%]
tests/test_code_generator_enhanced.py::test_generate_patch_with_file_contents PASSED [ 63%]
tests/test_code_generator_enhanced.py::test_generate_patch_with_deployment_credentials PASSED [ 63%]
tests/test_code_generator_enhanced.py::test_generate_patch_api_error_fallback PASSED [ 64%]
tests/test_code_generator_enhanced.py::test_extract_diff_with_markdown_diff PASSED [ 64%]
tests/test_code_generator_enhanced.py::test_extract_diff_with_plain_markdown PASSED [ 65%]
tests/test_code_generator_enhanced.py::test_extract_diff_no_markdown PASSED [ 65%]
tests/test_code_generator_enhanced.py::test_extract_diff_with_surrounding_text PASSED [ 66%]
tests/test_code_generator_enhanced.py::test_extract_diff_no_markers PASSED [ 66%]
tests/test_code_generator_enhanced.py::test_extract_files_from_diff PASSED [ 67%]
tests/test_code_generator_enhanced.py::test_extract_files_from_diff_with_dev_null PASSED [ 67%]
tests/test_code_generator_enhanced.py::test_extract_files_from_diff_deletion PASSED [ 68%]
tests/test_code_generator_enhanced.py::test_count_changes_additions_deletions PASSED [ 68%]
tests/test_code_generator_enhanced.py::test_count_changes_ignores_headers PASSED [ 69%]
tests/test_code_generator_enhanced.py::test_generate_mock_patch_create PASSED [ 69%]
tests/test_code_generator_enhanced.py::test_generate_mock_patch_modify PASSED [ 70%]
tests/test_code_generator_enhanced.py::test_generate_mock_patch_delete PASSED [ 70%]
tests/test_code_generator_enhanced.py::test_generate_mock_patch_multiple_files PASSED [ 71%]
tests/test_code_generator_enhanced.py::test_create_fallback_patch PASSED [ 71%]
tests/test_code_generator_enhanced.py::test_generate_patch_from_feedback PASSED [ 72%]
tests/test_code_generator_enhanced.py::test_generate_patch_with_long_file_content PASSED [ 72%]
tests/test_code_generator_enhanced.py::test_generate_patch_without_file_contents PASSED [ 73%]
tests/test_code_generator_enhanced.py::test_extract_files_duplicate_handling PASSED [ 73%]
tests/test_code_generator_enhanced.py::test_generate_mock_patch_with_file_contents PASSED [ 74%]
tests/test_code_generator_enhanced.py::test_generate_patch_model_parameter PASSED [ 75%]
tests/test_code_generator_enhanced.py::test_generate_patch_confidence_value PASSED [ 75%]
tests/test_code_generator_enhanced.py::test_count_changes_empty_diff PASSED [ 76%]
tests/test_code_generator_enhanced.py::test_extract_files_empty_diff PASSED [ 76%]
tests/test_ai_orchestrator.py::test_orchestrator_initialization PASSED   [ 77%]
tests/test_ai_orchestrator.py::test_plan_simple_task PASSED              [ 77%]
tests/test_ai_orchestrator.py::test_plan_complex_task PASSED             [ 78%]
tests/test_ai_orchestrator.py::test_plan_with_context PASSED             [ 78%]
tests/test_ai_orchestrator.py::test_plan_budget_exceeded PASSED          [ 79%]
tests/test_ai_orchestrator.py::test_generate_patch PASSED                [ 79%]
tests/test_ai_orchestrator.py::test_generate_patch_with_files PASSED     [ 80%]
tests/test_ai_orchestrator.py::test_review_patch PASSED                  [ 80%]
tests/test_ai_orchestrator.py::test_review_large_patch PASSED            [ 81%]
tests/test_ai_orchestrator.py::test_review_patch_without_tests PASSED    [ 81%]
tests/test_ai_orchestrator.py::test_diagnose_failure PASSED              [ 82%]
tests/test_ai_orchestrator.py::test_get_status PASSED                    [ 82%]
tests/test_ai_orchestrator.py::test_force_model_selection PASSED         [ 83%]
tests/test_ai_orchestrator.py::test_model_escalation_on_failure PASSED   [ 83%]
tests/test_ai_orchestrator.py::test_find_model_by_name PASSED            [ 84%]
tests/test_ai_orchestrator.py::test_find_model_by_name_not_found PASSED  [ 84%]
tests/test_ai_orchestrator_enhanced.py::test_plan_with_force_model PASSED [ 85%]
tests/test_ai_orchestrator_enhanced.py::test_plan_with_invalid_force_model PASSED [ 85%]
tests/test_ai_orchestrator_enhanced.py::test_plan_budget_exceeded PASSED [ 86%]
tests/test_ai_orchestrator_enhanced.py::test_plan_with_repo_context PASSED [ 86%]
tests/test_ai_orchestrator_enhanced.py::test_plan_escalation_on_failure PASSED [ 87%]
tests/test_ai_orchestrator_enhanced.py::test_plan_escalation_budget_check PASSED [ 87%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_with_force_model PASSED [ 88%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_invalid_force_model PASSED [ 88%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_low_complexity PASSED [ 89%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_high_complexity PASSED [ 89%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_with_file_contents PASSED [ 90%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_budget_exceeded PASSED [ 90%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_escalation_on_failure PASSED [ 91%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_escalation_budget_check PASSED [ 91%]
tests/test_ai_orchestrator_enhanced.py::test_review_patch_large_patch PASSED [ 92%]
tests/test_ai_orchestrator_enhanced.py::test_review_patch_no_tests PASSED [ 92%]
tests/test_ai_orchestrator_enhanced.py::test_review_patch_with_tests PASSED [ 93%]
tests/test_ai_orchestrator_enhanced.py::test_review_patch_with_context PASSED [ 93%]
tests/test_ai_orchestrator_enhanced.py::test_diagnose_failure PASSED     [ 94%]
tests/test_ai_orchestrator_enhanced.py::test_diagnose_failure_with_context PASSED [ 94%]
tests/test_ai_orchestrator_enhanced.py::test_get_status PASSED           [ 95%]
tests/test_ai_orchestrator_enhanced.py::test_find_model_by_name_found PASSED [ 95%]
tests/test_ai_orchestrator_enhanced.py::test_find_model_by_name_not_found PASSED [ 96%]
tests/test_ai_orchestrator_enhanced.py::test_task_type_enum PASSED       [ 96%]
tests/test_ai_orchestrator_enhanced.py::test_plan_response_dataclass PASSED [ 97%]
tests/test_ai_orchestrator_enhanced.py::test_patch_response_dataclass PASSED [ 97%]
tests/test_ai_orchestrator_enhanced.py::test_review_response_dataclass PASSED [ 98%]
tests/test_ai_orchestrator_enhanced.py::test_orchestrator_initialization_with_custom_config PASSED [ 98%]
tests/test_ai_orchestrator_enhanced.py::test_generate_patch_empty_file_contents PASSED [ 99%]
tests/test_ai_orchestrator_enhanced.py::test_diagnose_failure_long_output PASSED [100%]

================================ tests coverage ================================
_______________ coverage: platform linux, python 3.11.6-final-0 ________________

Name                                       Stmts   Miss  Cover   Missing
------------------------------------------------------------------------
sologit/__init__.py                            3      0   100%
sologit/api/__init__.py                        0      0   100%
sologit/api/client.py                         87     60    31%   68-69, 72-73, 94-120, 154-195, 230-272
sologit/cli/__init__.py                        0      0   100%
sologit/cli/commands.py                      234    234     0%   8-350
sologit/cli/config_commands.py               135    135     0%   8-224
sologit/cli/main.py                           70     70     0%   9-140
sologit/config/__init__.py                     0      0   100%
sologit/config/manager.py                    154     31    80%   29, 197-200, 250, 252, 256, 260, 267-294, 298, 302, 306-309, 318-338
sologit/config/templates.py                    2      2     0%   7-80
sologit/core/__init__.py                       0      0   100%
sologit/core/repository.py                    32     32     0%   9-68
sologit/core/workpad.py                       49     49     0%   9-118
sologit/engines/__init__.py                    0      0   100%
sologit/engines/git_engine.py                606    606     0%   9-1414
sologit/engines/patch_engine.py              209    209     0%   8-560
sologit/engines/test_orchestrator.py         134    134     0%   9-339
sologit/orchestration/__init__.py              6      0   100%
sologit/orchestration/ai_orchestrator.py     131      0   100%
sologit/orchestration/code_generator.py      138      0   100%
sologit/orchestration/cost_guard.py          134      3    98%   122-123, 136
sologit/orchestration/model_router.py        133      0   100%
sologit/orchestration/planning_engine.py     114      2    98%   267-268
sologit/utils/__init__.py                      0      0   100%
sologit/utils/logger.py                       63     37    41%   39-40, 43-49, 61-95, 110, 119-121, 124-126, 129
------------------------------------------------------------------------
TOTAL                                       2434   1604    34%
Coverage HTML written to dir htmlcov
============================= 196 passed in 8.55s ==============================
